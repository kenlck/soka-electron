"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[149],{7433:function(t,e,s){s.d(e,{c:function(){return a}});var i=s(7462),r=s(7294),n=s(5852),o=s(5878);const a=r.forwardRef((({makeDefault:t,...e},s)=>{const a=(0,n.Ky)((({set:t})=>t)),h=(0,n.Ky)((({camera:t})=>t)),c=(0,n.Ky)((({size:t})=>t)),l=r.useRef();return r.useLayoutEffect((()=>{const{current:t}=l;t&&!e.manual&&(t.aspect=c.width/c.height,t.updateProjectionMatrix())}),[c,e]),r.useLayoutEffect((()=>{if(t&&l.current){const t=h;return a((()=>({camera:l.current}))),()=>a((()=>({camera:t})))}}),[h,l,t,a]),r.createElement("perspectiveCamera",(0,i.Z)({ref:(0,o.Z)([l,s])},e))}))},7854:function(t,e,s){s.d(e,{V:function(){return y}});var i=s(7462),r=s(7294),n=s(3935),o=s(9477),a=s(5852);const h=new o.Vector3,c=new o.Vector3,l=new o.Vector3;function d(t,e,s){const i=h.setFromMatrixPosition(t.matrixWorld);i.project(e);const r=s.width/2,n=s.height/2;return[i.x*r+r,-i.y*n+n]}const m=t=>Math.abs(t)<1e-10?0:t;function _(t,e,s=""){let i="matrix3d(";for(let r=0;16!==r;r++)i+=m(e[r]*t.elements[r])+(15!==r?",":")");return s+i}const u=(p=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],t=>_(t,p));var p;const f=(t,e)=>{return _(t,[1/(s=e),1/s,1/s,1,-1/s,-1/s,-1/s,-1,1/s,1/s,1/s,1,1,1,1,1],"translate(-50%,-50%)");var s},y=r.forwardRef((({children:t,eps:e=.001,style:s,className:_,prepend:p,center:y,fullscreen:E,portal:g,distanceFactor:v,sprite:O=!1,transform:T=!1,occlude:x,onOcclude:C,zIndexRange:w=[16777271,0],calculatePosition:P=d,as:A="div",wrapperClass:U,pointerEvents:b="auto",...z},F)=>{var M;const D=(0,a.Ky)((({gl:t})=>t)),L=(0,a.Ky)((({camera:t})=>t)),S=(0,a.Ky)((({scene:t})=>t)),R=(0,a.Ky)((({size:t})=>t)),k=(0,a.Ky)((({raycaster:t})=>t)),[V]=r.useState((()=>document.createElement(A))),I=r.useRef(null),B=r.useRef(0),N=r.useRef([0,0]),Y=r.useRef(null),H=r.useRef(null),Z=null!==(M=null==g?void 0:g.current)&&void 0!==M?M:D.domElement.parentNode;r.useEffect((()=>{if(I.current){if(S.updateMatrixWorld(),T)V.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const t=P(I.current,L,R);V.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${t[0]}px,${t[1]}px,0);transform-origin:0 0;`}return Z&&(p?Z.prepend(V):Z.appendChild(V)),()=>{Z&&Z.removeChild(V),n.unmountComponentAtNode(V)}}}),[Z,T]),r.useLayoutEffect((()=>{U&&(V.className=U)}),[U]);const K=r.useMemo((()=>T?{position:"absolute",top:0,left:0,width:R.width,height:R.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:y?"translate3d(-50%,-50%,0)":"none",...E&&{top:-R.height/2,left:-R.width/2,width:R.width,height:R.height},...s}),[s,y,E,R,T]),X=r.useMemo((()=>({position:"absolute",pointerEvents:b})),[b]);r.useLayoutEffect((()=>{T?n.render(r.createElement("div",{ref:Y,style:K},r.createElement("div",{ref:H,style:X},r.createElement("div",{ref:F,className:_,style:s,children:t}))),V):n.render(r.createElement("div",{ref:F,style:K,className:_,children:t}),V)}));const W=r.useRef(!0);return(0,a.xQ)((()=>{if(I.current){L.updateMatrixWorld(),I.current.updateWorldMatrix(!0,!1);const t=T?N.current:P(I.current,L,R);if(T||Math.abs(B.current-L.zoom)>e||Math.abs(N.current[0]-t[0])>e||Math.abs(N.current[1]-t[1])>e){const e=function(t,e){const s=h.setFromMatrixPosition(t.matrixWorld),i=c.setFromMatrixPosition(e.matrixWorld),r=s.sub(i),n=e.getWorldDirection(l);return r.angleTo(n)>Math.PI/2}(I.current,L);let s=!1;"boolean"===typeof x?!0===x&&(s=[S]):Array.isArray(x)&&(s=x.map((t=>t.current)));const i=W.current;if(s){const t=function(t,e,s,i){const r=h.setFromMatrixPosition(t.matrixWorld),n=r.clone();n.project(e),s.setFromCamera(n,e);const o=s.intersectObjects(i,!0);if(o.length){const t=o[0].distance;return r.distanceTo(s.ray.origin)<t}return!0}(I.current,L,k,s);W.current=t&&!e}else W.current=!e;if(i!==W.current&&(C?C(!W.current):V.style.display=W.current?"block":"none"),V.style.zIndex=`${function(t,e,s){if(e instanceof o.PerspectiveCamera||e instanceof o.OrthographicCamera){const i=h.setFromMatrixPosition(t.matrixWorld),r=c.setFromMatrixPosition(e.matrixWorld),n=i.distanceTo(r),o=(s[1]-s[0])/(e.far-e.near),a=s[1]-o*e.far;return Math.round(o*n+a)}}(I.current,L,w)}`,T){const[t,e]=[R.width/2,R.height/2],s=L.projectionMatrix.elements[5]*e,{isOrthographicCamera:i,top:r,left:n,bottom:o,right:a}=L,h=u(L.matrixWorldInverse),c=i?`scale(${s})translate(${m(-(a+n)/2)}px,${m((r+o)/2)}px)`:`translateZ(${s}px)`;let l=I.current.matrixWorld;O&&(l=L.matrixWorldInverse.clone().transpose().copyPosition(l).scale(I.current.scale),l.elements[3]=l.elements[7]=l.elements[11]=0,l.elements[15]=1),V.style.width=R.width+"px",V.style.height=R.height+"px",V.style.perspective=i?"":`${s}px`,Y.current&&H.current&&(Y.current.style.transform=`${c}${h}translate(${t}px,${e}px)`,H.current.style.transform=f(l,1/((v||10)/400)))}else{const e=void 0===v?1:function(t,e){if(e instanceof o.OrthographicCamera)return e.zoom;if(e instanceof o.PerspectiveCamera){const s=h.setFromMatrixPosition(t.matrixWorld),i=c.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,n=s.distanceTo(i);return 1/(2*Math.tan(r/2)*n)}return 1}(I.current,L)*v;V.style.transform=`translate3d(${t[0]}px,${t[1]}px,0) scale(${e})`}N.current=t,B.current=L.zoom}}})),r.createElement("group",(0,i.Z)({},z,{ref:I}))}))},105:function(t,e,s){var i;function r(t){return t.isPerspectiveCamera}function n(t){return t.isOrthographicCamera}s.d(e,{Z:function(){return N}}),function(t){t[t.NONE=0]="NONE",t[t.ROTATE=1]="ROTATE",t[t.TRUCK=2]="TRUCK",t[t.OFFSET=3]="OFFSET",t[t.DOLLY=4]="DOLLY",t[t.ZOOM=5]="ZOOM",t[t.TOUCH_ROTATE=6]="TOUCH_ROTATE",t[t.TOUCH_TRUCK=7]="TOUCH_TRUCK",t[t.TOUCH_OFFSET=8]="TOUCH_OFFSET",t[t.TOUCH_DOLLY=9]="TOUCH_DOLLY",t[t.TOUCH_ZOOM=10]="TOUCH_ZOOM",t[t.TOUCH_DOLLY_TRUCK=11]="TOUCH_DOLLY_TRUCK",t[t.TOUCH_DOLLY_OFFSET=12]="TOUCH_DOLLY_OFFSET",t[t.TOUCH_ZOOM_TRUCK=13]="TOUCH_ZOOM_TRUCK",t[t.TOUCH_ZOOM_OFFSET=14]="TOUCH_ZOOM_OFFSET"}(i||(i={}));const o=2*Math.PI,a=Math.PI/2;function h(t,e=1e-5){return Math.abs(t)<e}function c(t,e,s=1e-5){return h(t-e,s)}function l(t,e){return Math.round(t/e)*e}function d(t){return isFinite(t)?t:t<0?-Number.MAX_VALUE:Number.MAX_VALUE}function m(t){return Math.abs(t)<Number.MAX_VALUE?t:t*(1/0)}function _(t,e){e.set(0,0),t.forEach((t=>{e.x+=t.clientX,e.y+=t.clientY})),e.x/=t.length,e.y/=t.length}function u(t,e){return!!n(t)&&(console.warn(`${e} is not supported in OrthographicCamera`),!0)}function p(t){return t.invert?t.invert():t.inverse(),t}const f="undefined"!==typeof window,y=f&&/Mac/.test(navigator.platform),E=!(f&&"PointerEvent"in window),g=Object.freeze(i),v=1/8;let O,T,x,C,w,P,A,U,b,z,F,M,D,L,S,R,k,V,I,B;class N extends class{constructor(){this._listeners={}}addEventListener(t,e){const s=this._listeners;void 0===s[t]&&(s[t]=[]),-1===s[t].indexOf(e)&&s[t].push(e)}removeEventListener(t,e){const s=this._listeners[t];if(void 0!==s){const t=s.indexOf(e);-1!==t&&s.splice(t,1)}}removeAllEventListeners(t){t?Array.isArray(this._listeners[t])&&(this._listeners[t].length=0):this._listeners={}}dispatchEvent(t){const e=this._listeners[t.type];if(void 0!==e){t.target=this;const s=e.slice(0);for(let e=0,i=s.length;e<i;e++)s[e].call(this,t)}}}{constructor(t,e){if(super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=0,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.dampingFactor=.05,this.draggingDampingFactor=.25,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=i.NONE,this._viewport=null,this._dollyControlAmount=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._activePointers=[],this._truckInternal=(t,e,s)=>{if(r(this._camera)){const i=P.copy(this._camera.position).sub(this._target),r=this._camera.getEffectiveFOV()*O.MathUtils.DEG2RAD,n=i.length()*Math.tan(.5*r),o=this.truckSpeed*t*n/this._elementRect.height,a=this.truckSpeed*e*n/this._elementRect.height;this.verticalDragToForward?(s?this.setFocalOffset(this._focalOffsetEnd.x+o,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(o,0,!0),this.forward(-a,!0)):s?this.setFocalOffset(this._focalOffsetEnd.x+o,this._focalOffsetEnd.y+a,this._focalOffsetEnd.z,!0):this.truck(o,a,!0)}else if(n(this._camera)){const i=this._camera,r=t*(i.right-i.left)/i.zoom/this._elementRect.width,n=e*(i.top-i.bottom)/i.zoom/this._elementRect.height;s?this.setFocalOffset(this._focalOffsetEnd.x+r,this._focalOffsetEnd.y+n,this._focalOffsetEnd.z,!0):this.truck(r,n,!0)}},this._rotateInternal=(t,e)=>{const s=o*this.azimuthRotateSpeed*t/this._elementRect.height,i=o*this.polarRotateSpeed*e/this._elementRect.height;this.rotate(s,i,!0)},this._dollyInternal=(t,e,s)=>{const i=Math.pow(.95,-t*this.dollySpeed),r=this._sphericalEnd.radius*i,n=this._sphericalEnd.radius,o=n*(t>=0?-1:1);this.dollyTo(r),this.infinityDolly&&(r<this.minDistance||this.maxDistance===this.minDistance)&&(this._camera.getWorldDirection(P),this._targetEnd.add(P.normalize().multiplyScalar(o)),this._target.add(P.normalize().multiplyScalar(o))),this.dollyToCursor&&(this._dollyControlAmount+=this._sphericalEnd.radius-n,this.infinityDolly&&(r<this.minDistance||this.maxDistance===this.minDistance)&&(this._dollyControlAmount-=o),this._dollyControlCoord.set(e,s))},this._zoomInternal=(t,e,s)=>{const i=Math.pow(.95,t*this.dollySpeed);this.zoomTo(this._zoom*i),this.dollyToCursor&&(this._dollyControlAmount=this._zoomEnd,this._dollyControlCoord.set(e,s))},"undefined"===typeof O&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=t,this._yAxisUpSpace=(new O.Quaternion).setFromUnitVectors(this._camera.up,x),this._yAxisUpSpaceInverse=p(this._yAxisUpSpace.clone()),this._state=i.NONE,this._domElement=e,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._target=new O.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new O.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=(new O.Spherical).setFromVector3(P.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._nearPlaneCorners=[new O.Vector3,new O.Vector3,new O.Vector3,new O.Vector3],this._updateNearPlaneCorners(),this._boundary=new O.Box3(new O.Vector3(-1/0,-1/0,-1/0),new O.Vector3(1/0,1/0,1/0)),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlAmount=0,this._dollyControlCoord=new O.Vector2,this.mouseButtons={left:i.ROTATE,middle:i.DOLLY,right:i.TRUCK,wheel:r(this._camera)?i.DOLLY:n(this._camera)?i.ZOOM:i.NONE,shiftLeft:i.NONE},this.touches={one:i.TOUCH_ROTATE,two:r(this._camera)?i.TOUCH_DOLLY_TRUCK:n(this._camera)?i.TOUCH_ZOOM_TRUCK:i.NONE,three:i.TOUCH_TRUCK},this._domElement){const t=new O.Vector2,e=new O.Vector2,s=new O.Vector2,r=t=>{if(!this._enabled)return;const e={pointerId:t.pointerId,clientX:t.clientX,clientY:t.clientY};switch(this._activePointers.push(e),t.button){case O.MOUSE.LEFT:this._state=t.shiftKey?this.mouseButtons.shiftLeft:this.mouseButtons.left;break;case O.MOUSE.MIDDLE:this._state=this.mouseButtons.middle;break;case O.MOUSE.RIGHT:this._state=this.mouseButtons.right}if("touch"===t.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",l),g()},n=t=>{if(!this._enabled)return;const e={pointerId:0,clientX:t.clientX,clientY:t.clientY};switch(this._activePointers.push(e),t.button){case O.MOUSE.LEFT:this._state=t.shiftKey?this.mouseButtons.shiftLeft:this.mouseButtons.left;break;case O.MOUSE.MIDDLE:this._state=this.mouseButtons.middle;break;case O.MOUSE.RIGHT:this._state=this.mouseButtons.right}this._domElement.ownerDocument.removeEventListener("mousemove",h),this._domElement.ownerDocument.removeEventListener("mouseup",d),this._domElement.ownerDocument.addEventListener("mousemove",h),this._domElement.ownerDocument.addEventListener("mouseup",d),g()},o=t=>{if(this._enabled){switch(t.preventDefault(),Array.prototype.forEach.call(t.changedTouches,(t=>{const e={pointerId:t.identifier,clientX:t.clientX,clientY:t.clientY};this._activePointers.push(e)})),this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}this._domElement.ownerDocument.removeEventListener("touchmove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("touchend",m),this._domElement.ownerDocument.addEventListener("touchmove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("touchend",m),g()}},a=t=>{t.cancelable&&t.preventDefault();const e=t.pointerId,s=this._findPointerById(e);s&&(s.clientX=t.clientX,s.clientY=t.clientY,T())},h=t=>{const e=this._findPointerById(0);e&&(e.clientX=t.clientX,e.clientY=t.clientY,T())},c=t=>{t.cancelable&&t.preventDefault(),Array.prototype.forEach.call(t.changedTouches,(t=>{const e=t.identifier,s=this._findPointerById(e);s&&(s.clientX=t.clientX,s.clientY=t.clientY)})),T()},l=t=>{const e=t.pointerId,s=this._findPointerById(e);if(s&&this._activePointers.splice(this._activePointers.indexOf(s),1),"touch"===t.pointerType)switch(this._activePointers.length){case 0:this._state=i.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=i.NONE;x()},d=()=>{const t=this._findPointerById(0);t&&this._activePointers.splice(this._activePointers.indexOf(t),1),this._state=i.NONE,x()},m=t=>{switch(Array.prototype.forEach.call(t.changedTouches,(t=>{const e=t.identifier,s=this._findPointerById(e);s&&this._activePointers.splice(this._activePointers.indexOf(s),1)})),this._activePointers.length){case 0:this._state=i.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}x()};let u=-1;const p=t=>{if(!this._enabled||this.mouseButtons.wheel===i.NONE)return;if(t.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===i.ROTATE||this.mouseButtons.wheel===i.TRUCK){const t=performance.now();u-t<1e3&&this._getClientRect(this._elementRect),u=t}const e=y?-1:-3,s=1===t.deltaMode?t.deltaY/e:t.deltaY/(10*e),r=this.dollyToCursor?(t.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,n=this.dollyToCursor?(t.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case i.ROTATE:this._rotateInternal(t.deltaX,t.deltaY);break;case i.TRUCK:this._truckInternal(t.deltaX,t.deltaY,!1);break;case i.OFFSET:this._truckInternal(t.deltaX,t.deltaY,!0);break;case i.DOLLY:this._dollyInternal(-s,r,n);break;case i.ZOOM:this._zoomInternal(-s,r,n)}this.dispatchEvent({type:"control"})},f=t=>{this._enabled&&t.preventDefault()},g=()=>{if(!this._enabled)return;_(this._activePointers,w),this._getClientRect(this._elementRect),t.copy(w),e.copy(w);if(this._activePointers.length>=2){const t=w.x-this._activePointers[1].clientX,i=w.y-this._activePointers[1].clientY,r=Math.sqrt(t*t+i*i);s.set(0,r);const n=.5*(this._activePointers[0].clientX+this._activePointers[1].clientX),o=.5*(this._activePointers[0].clientY+this._activePointers[1].clientY);e.set(n,o)}this.dispatchEvent({type:"controlstart"})},T=()=>{if(!this._enabled)return;_(this._activePointers,w);const r=e.x-w.x,n=e.y-w.y;switch(e.copy(w),this._state){case i.ROTATE:case i.TOUCH_ROTATE:this._rotateInternal(r,n);break;case i.DOLLY:case i.ZOOM:{const e=this.dollyToCursor?(t.x-this._elementRect.x)/this._elementRect.width*2-1:0,s=this.dollyToCursor?(t.y-this._elementRect.y)/this._elementRect.height*-2+1:0;this._state===i.DOLLY?this._dollyInternal(n*v,e,s):this._zoomInternal(n*v,e,s);break}case i.TOUCH_DOLLY:case i.TOUCH_ZOOM:case i.TOUCH_DOLLY_TRUCK:case i.TOUCH_ZOOM_TRUCK:case i.TOUCH_DOLLY_OFFSET:case i.TOUCH_ZOOM_OFFSET:{const t=w.x-this._activePointers[1].clientX,o=w.y-this._activePointers[1].clientY,a=Math.sqrt(t*t+o*o),h=s.y-a;s.set(0,a);const c=this.dollyToCursor?(e.x-this._elementRect.x)/this._elementRect.width*2-1:0,l=this.dollyToCursor?(e.y-this._elementRect.y)/this._elementRect.height*-2+1:0;this._state===i.TOUCH_DOLLY||this._state===i.TOUCH_DOLLY_TRUCK||this._state===i.TOUCH_DOLLY_OFFSET?this._dollyInternal(h*v,c,l):this._zoomInternal(h*v,c,l),this._state===i.TOUCH_DOLLY_TRUCK||this._state===i.TOUCH_ZOOM_TRUCK?this._truckInternal(r,n,!1):this._state!==i.TOUCH_DOLLY_OFFSET&&this._state!==i.TOUCH_ZOOM_OFFSET||this._truckInternal(r,n,!0);break}case i.TRUCK:case i.TOUCH_TRUCK:this._truckInternal(r,n,!1);break;case i.OFFSET:case i.TOUCH_OFFSET:this._truckInternal(r,n,!0)}this.dispatchEvent({type:"control"})},x=()=>{_(this._activePointers,w),e.copy(w),0===this._activePointers.length&&(this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.removeEventListener("touchmove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("touchend",m),this.dispatchEvent({type:"controlend"}))};this._domElement.addEventListener("pointerdown",r),E&&this._domElement.addEventListener("mousedown",n),E&&this._domElement.addEventListener("touchstart",o),this._domElement.addEventListener("pointercancel",l),this._domElement.addEventListener("wheel",p,{passive:!1}),this._domElement.addEventListener("contextmenu",f),this._removeAllEventListeners=()=>{this._domElement.removeEventListener("pointerdown",r),this._domElement.removeEventListener("mousedown",n),this._domElement.removeEventListener("touchstart",o),this._domElement.removeEventListener("pointercancel",l),this._domElement.removeEventListener("wheel",p,{passive:!1}),this._domElement.removeEventListener("contextmenu",f),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",h),this._domElement.ownerDocument.removeEventListener("touchmove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.removeEventListener("mouseup",d),this._domElement.ownerDocument.removeEventListener("touchend",m)},this.cancel=()=>{this._state!==i.NONE&&(this._state=i.NONE,this._activePointers.length=0,x())}}this.update(0)}static install(t){O=t.THREE,T=Object.freeze(new O.Vector3(0,0,0)),x=Object.freeze(new O.Vector3(0,1,0)),C=Object.freeze(new O.Vector3(0,0,1)),w=new O.Vector2,P=new O.Vector3,A=new O.Vector3,U=new O.Vector3,b=new O.Vector3,z=new O.Vector3,F=new O.Vector3,M=new O.Spherical,D=new O.Spherical,L=new O.Box3,S=new O.Box3,R=new O.Sphere,k=new O.Quaternion,V=new O.Quaternion,I=new O.Matrix4,B=new O.Raycaster}static get ACTION(){return g}get camera(){return this._camera}set camera(t){this._camera=t,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(t){this._enabled=t,t?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="")}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(t){this._spherical.radius===t&&this._sphericalEnd.radius===t||(this._spherical.radius=t,this._sphericalEnd.radius=t,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(t){this._spherical.theta===t&&this._sphericalEnd.theta===t||(this._spherical.theta=t,this._sphericalEnd.theta=t,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(t){this._spherical.phi===t&&this._sphericalEnd.phi===t||(this._spherical.phi=t,this._sphericalEnd.phi=t,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(t){this._boundaryEnclosesCamera=t,this._needsUpdate=!0}addEventListener(t,e){super.addEventListener(t,e)}removeEventListener(t,e){super.removeEventListener(t,e)}rotate(t,e,s=!1){return this.rotateTo(this._sphericalEnd.theta+t,this._sphericalEnd.phi+e,s)}rotateAzimuthTo(t,e=!1){return this.rotateTo(t,this._sphericalEnd.phi,e)}rotatePolarTo(t,e=!1){return this.rotateTo(this._sphericalEnd.theta,t,e)}rotateTo(t,e,s=!1){const i=O.MathUtils.clamp(t,this.minAzimuthAngle,this.maxAzimuthAngle),r=O.MathUtils.clamp(e,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=i,this._sphericalEnd.phi=r,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,s||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const n=!s||c(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&c(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(n)}dolly(t,e=!1){return this.dollyTo(this._sphericalEnd.radius-t,e)}dollyTo(t,e=!1){const s=this._sphericalEnd.radius,i=O.MathUtils.clamp(t,this.minDistance,this.maxDistance);if(this.colliderMeshes.length>=1){const t=this._collisionTest(),e=c(t,this._spherical.radius);if(!(s>i)&&e)return Promise.resolve();this._sphericalEnd.radius=Math.min(i,t)}else this._sphericalEnd.radius=i;this._needsUpdate=!0,e||(this._spherical.radius=this._sphericalEnd.radius);const r=!e||c(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(r)}zoom(t,e=!1){return this.zoomTo(this._zoomEnd+t,e)}zoomTo(t,e=!1){this._zoomEnd=O.MathUtils.clamp(t,this.minZoom,this.maxZoom),this._needsUpdate=!0,e||(this._zoom=this._zoomEnd);const s=!e||c(this._zoom,this._zoomEnd,this.restThreshold);return this._createOnRestPromise(s)}pan(t,e,s=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(t,e,s)}truck(t,e,s=!1){this._camera.updateMatrix(),b.setFromMatrixColumn(this._camera.matrix,0),z.setFromMatrixColumn(this._camera.matrix,1),b.multiplyScalar(t),z.multiplyScalar(-e);const i=P.copy(b).add(z),r=A.copy(this._targetEnd).add(i);return this.moveTo(r.x,r.y,r.z,s)}forward(t,e=!1){P.setFromMatrixColumn(this._camera.matrix,0),P.crossVectors(this._camera.up,P),P.multiplyScalar(t);const s=A.copy(this._targetEnd).add(P);return this.moveTo(s.x,s.y,s.z,e)}moveTo(t,e,s,i=!1){const r=P.set(t,e,s).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,r,this.boundaryFriction),this._needsUpdate=!0,i||this._target.copy(this._targetEnd);const n=!i||c(this._target.x,this._targetEnd.x,this.restThreshold)&&c(this._target.y,this._targetEnd.y,this.restThreshold)&&c(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}fitToBox(t,e,{paddingLeft:s=0,paddingRight:i=0,paddingBottom:o=0,paddingTop:h=0}={}){const d=[],m=t.isBox3?L.copy(t):L.setFromObject(t);m.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const _=l(this._sphericalEnd.theta,a),u=l(this._sphericalEnd.phi,a);d.push(this.rotateTo(_,u,e));const p=P.setFromSpherical(this._sphericalEnd).normalize(),f=k.setFromUnitVectors(p,C);c(Math.abs(p.y),1)&&f.multiply(V.setFromAxisAngle(x,_));const y=S.makeEmpty();A.copy(m.min).applyQuaternion(f),y.expandByPoint(A),A.copy(m.min).setX(m.max.x).applyQuaternion(f),y.expandByPoint(A),A.copy(m.min).setY(m.max.y).applyQuaternion(f),y.expandByPoint(A),A.copy(m.max).setZ(m.min.z).applyQuaternion(f),y.expandByPoint(A),A.copy(m.min).setZ(m.max.z).applyQuaternion(f),y.expandByPoint(A),A.copy(m.max).setY(m.min.y).applyQuaternion(f),y.expandByPoint(A),A.copy(m.max).setX(m.min.x).applyQuaternion(f),y.expandByPoint(A),A.copy(m.max).applyQuaternion(f),y.expandByPoint(A),f.setFromUnitVectors(C,p),y.min.x-=s,y.min.y-=o,y.max.x+=i,y.max.y+=h;const E=y.getSize(P),g=y.getCenter(A).applyQuaternion(f);if(r(this._camera)){const t=this.getDistanceToFitBox(E.x,E.y,E.z);d.push(this.moveTo(g.x,g.y,g.z,e)),d.push(this.dollyTo(t,e)),d.push(this.setFocalOffset(0,0,0,e))}else if(n(this._camera)){const t=this._camera,s=t.right-t.left,i=t.top-t.bottom,r=Math.min(s/E.x,i/E.y);d.push(this.moveTo(g.x,g.y,g.z,e)),d.push(this.zoomTo(r,e)),d.push(this.setFocalOffset(0,0,0,e))}return Promise.all(d)}fitTo(t,e,s={}){return console.warn("camera-controls: fitTo() has been renamed to fitToBox()"),this.fitToBox(t,e,s)}fitToSphere(t,e){const s=[],i=t instanceof O.Sphere?R.copy(t):function(t,e){const s=e,i=s.center;t.traverse((t=>{t.isMesh&&L.expandByObject(t)})),L.getCenter(i);let r=0;return t.traverse((t=>{if(!t.isMesh)return;const e=t,s=e.geometry.clone();if(s.applyMatrix4(e.matrixWorld),s.isBufferGeometry){const t=s.attributes.position;for(let e=0,s=t.count;e<s;e++)P.fromBufferAttribute(t,e),r=Math.max(r,i.distanceToSquared(P))}else{const t=s.attributes.position,e=new O.Vector3;for(let s=0,n=t.count;s<n;s++)e.fromBufferAttribute(t,s),r=Math.max(r,i.distanceToSquared(e))}})),s.radius=Math.sqrt(r),s}(t,R);if(s.push(this.moveTo(i.center.x,i.center.y,i.center.z,e)),r(this._camera)){const t=this.getDistanceToFitSphere(i.radius);s.push(this.dollyTo(t,e))}else if(n(this._camera)){const t=this._camera.right-this._camera.left,r=this._camera.top-this._camera.bottom,n=2*i.radius,o=Math.min(t/n,r/n);s.push(this.zoomTo(o,e))}return s.push(this.setFocalOffset(0,0,0,e)),Promise.all(s)}setLookAt(t,e,s,i,r,n,o=!1){const a=A.set(i,r,n),h=P.set(t,e,s);this._targetEnd.copy(a),this._sphericalEnd.setFromVector3(h.sub(a).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,o||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const l=!o||c(this._target.x,this._targetEnd.x,this.restThreshold)&&c(this._target.y,this._targetEnd.y,this.restThreshold)&&c(this._target.z,this._targetEnd.z,this.restThreshold)&&c(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&c(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&c(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(l)}lerpLookAt(t,e,s,i,r,n,o,a,h,l,d,m,_,u=!1){const p=P.set(i,r,n),f=A.set(t,e,s);M.setFromVector3(f.sub(p).applyQuaternion(this._yAxisUpSpace));const y=U.set(l,d,m),E=A.set(o,a,h);D.setFromVector3(E.sub(y).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(p.lerp(y,_));const g=D.theta-M.theta,v=D.phi-M.phi,O=D.radius-M.radius;this._sphericalEnd.set(M.radius+O*_,M.phi+v*_,M.theta+g*_),this.normalizeRotations(),this._needsUpdate=!0,u||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const T=!u||c(this._target.x,this._targetEnd.x,this.restThreshold)&&c(this._target.y,this._targetEnd.y,this.restThreshold)&&c(this._target.z,this._targetEnd.z,this.restThreshold)&&c(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&c(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&c(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(T)}setPosition(t,e,s,i=!1){return this.setLookAt(t,e,s,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,i)}setTarget(t,e,s,i=!1){const r=this.getPosition(P);return this.setLookAt(r.x,r.y,r.z,t,e,s,i)}setFocalOffset(t,e,s,i=!1){this._focalOffsetEnd.set(t,e,s),this._needsUpdate=!0,i||this._focalOffset.copy(this._focalOffsetEnd);const r=!i||c(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&c(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&c(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}setOrbitPoint(t,e,s){b.setFromMatrixColumn(this._camera.matrixWorldInverse,0),z.setFromMatrixColumn(this._camera.matrixWorldInverse,1),F.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const i=P.set(t,e,s),r=i.distanceTo(this._camera.position),n=i.sub(this._camera.position);b.multiplyScalar(n.x),z.multiplyScalar(n.y),F.multiplyScalar(n.z),P.copy(b).add(z).add(F),P.z=P.z+r,this.dollyTo(r,!1),this.setFocalOffset(-P.x,P.y,-P.z,!1),this.moveTo(t,e,s,!1)}setBoundary(t){if(!t)return this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),void(this._needsUpdate=!0);this._boundary.copy(t),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(t,e,s,i){null!==t?(this._viewport=this._viewport||new O.Vector4,"number"===typeof t?this._viewport.set(t,e,s,i):this._viewport.copy(t)):this._viewport=null}getDistanceToFitBox(t,e,s){if(u(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const i=t/e,r=this._camera.getEffectiveFOV()*O.MathUtils.DEG2RAD,n=this._camera.aspect;return.5*(i<n?e:t/n)/Math.tan(.5*r)+.5*s}getDistanceToFit(t,e,s){return console.warn("camera-controls: getDistanceToFit() has been renamed to getDistanceToFitBox()"),this.getDistanceToFitBox(t,e,s)}getDistanceToFitSphere(t){if(u(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const e=this._camera.getEffectiveFOV()*O.MathUtils.DEG2RAD,s=2*Math.atan(Math.tan(.5*e)*this._camera.aspect),i=1<this._camera.aspect?e:s;return t/Math.sin(.5*i)}getTarget(t){return(t&&t.isVector3?t:new O.Vector3).copy(this._targetEnd)}getPosition(t){return(t&&t.isVector3?t:new O.Vector3).setFromSpherical(this._sphericalEnd).applyQuaternion(this._yAxisUpSpaceInverse).add(this._targetEnd)}getFocalOffset(t){return(t&&t.isVector3?t:new O.Vector3).copy(this._focalOffsetEnd)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%o,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=o),this._spherical.theta+=o*Math.round((this._sphericalEnd.theta-this._spherical.theta)/o)}reset(t=!1){const e=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,t),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,t),this.zoomTo(this._zoom0,t)];return Promise.all(e)}saveState(){this._target0.copy(this._target),this._position0.copy(this._camera.position),this._zoom0=this._zoom}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,x),p(this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace))}update(t){const e=this._state===i.NONE?this.dampingFactor:this.draggingDampingFactor,s=Math.min(e*t*60,1),o=this._sphericalEnd.theta-this._spherical.theta,a=this._sphericalEnd.phi-this._spherical.phi,c=this._sphericalEnd.radius-this._spherical.radius,l=P.subVectors(this._targetEnd,this._target),d=A.subVectors(this._focalOffsetEnd,this._focalOffset);if(h(o)&&h(a)&&h(c)&&h(l.x)&&h(l.y)&&h(l.z)&&h(d.x)&&h(d.y)&&h(d.z)?(this._spherical.copy(this._sphericalEnd),this._target.copy(this._targetEnd),this._focalOffset.copy(this._focalOffsetEnd)):(this._spherical.set(this._spherical.radius+c*s,this._spherical.phi+a*s,this._spherical.theta+o*s),this._target.add(l.multiplyScalar(s)),this._focalOffset.add(d.multiplyScalar(s)),this._needsUpdate=!0),0!==this._dollyControlAmount){if(r(this._camera)){const t=this._camera,e=P.setFromSpherical(this._sphericalEnd).applyQuaternion(this._yAxisUpSpaceInverse).normalize().negate(),s=A.copy(e).cross(t.up).normalize();0===s.lengthSq()&&(s.x=1);const i=U.crossVectors(s,e),r=this._sphericalEnd.radius*Math.tan(t.getEffectiveFOV()*O.MathUtils.DEG2RAD*.5),n=(this._sphericalEnd.radius-this._dollyControlAmount-this._sphericalEnd.radius)/this._sphericalEnd.radius,o=P.copy(this._targetEnd).add(s.multiplyScalar(this._dollyControlCoord.x*r*t.aspect)).add(i.multiplyScalar(this._dollyControlCoord.y*r));this._targetEnd.lerp(o,n),this._target.copy(this._targetEnd)}else if(n(this._camera)){const t=this._camera,e=P.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(t.near+t.far)/(t.near-t.far)).unproject(t),s=A.set(0,0,-1).applyQuaternion(t.quaternion),i=s.dot(t.up),r=h(i)?-e.dot(t.up):-e.dot(t.up)/i,n=U.copy(e).add(s.multiplyScalar(r));this._targetEnd.lerp(n,1-t.zoom/this._dollyControlAmount),this._target.copy(this._targetEnd)}this._dollyControlAmount=0}const m=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,m),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target);(!h(this._focalOffset.x)||!h(this._focalOffset.y)||!h(this._focalOffset.z))&&(this._camera.updateMatrix(),b.setFromMatrixColumn(this._camera.matrix,0),z.setFromMatrixColumn(this._camera.matrix,1),F.setFromMatrixColumn(this._camera.matrix,2),b.multiplyScalar(this._focalOffset.x),z.multiplyScalar(-this._focalOffset.y),F.multiplyScalar(this._focalOffset.z),P.copy(b).add(z).add(F),this._camera.position.add(P)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),P.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const _=this._zoomEnd-this._zoom;this._zoom+=_*s,this._camera.zoom!==this._zoom&&(h(_)&&(this._zoom=this._zoomEnd),this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0);const u=this._needsUpdate;return u&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):u?(this.dispatchEvent({type:"update"}),h(o,this.restThreshold)&&h(a,this.restThreshold)&&h(c,this.restThreshold)&&h(l.x,this.restThreshold)&&h(l.y,this.restThreshold)&&h(l.z,this.restThreshold)&&h(d.x,this.restThreshold)&&h(d.y,this.restThreshold)&&h(d.z,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!u&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._updatedLastTime=u,this._needsUpdate=!1,u}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:d(this.maxDistance),minZoom:this.minZoom,maxZoom:d(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:d(this.maxPolarAngle),minAzimuthAngle:d(this.minAzimuthAngle),maxAzimuthAngle:d(this.maxAzimuthAngle),dampingFactor:this.dampingFactor,draggingDampingFactor:this.draggingDampingFactor,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:P.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(t,e=!1){const s=JSON.parse(t),i=P.fromArray(s.position);this.enabled=s.enabled,this.minDistance=s.minDistance,this.maxDistance=m(s.maxDistance),this.minZoom=s.minZoom,this.maxZoom=m(s.maxZoom),this.minPolarAngle=s.minPolarAngle,this.maxPolarAngle=m(s.maxPolarAngle),this.minAzimuthAngle=m(s.minAzimuthAngle),this.maxAzimuthAngle=m(s.maxAzimuthAngle),this.dampingFactor=s.dampingFactor,this.draggingDampingFactor=s.draggingDampingFactor,this.dollySpeed=s.dollySpeed,this.truckSpeed=s.truckSpeed,this.dollyToCursor=s.dollyToCursor,this.verticalDragToForward=s.verticalDragToForward,this._target0.fromArray(s.target0),this._position0.fromArray(s.position0),this._zoom0=s.zoom0,this._focalOffset0.fromArray(s.focalOffset0),this.moveTo(s.target[0],s.target[1],s.target[2],e),M.setFromVector3(i.sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(M.theta,M.phi,e),this.zoomTo(s.zoom,e),this.setFocalOffset(s.focalOffset[0],s.focalOffset[1],s.focalOffset[2],e),this._needsUpdate=!0}dispose(){this._removeAllEventListeners()}_findPointerById(t){let e=null;return this._activePointers.some((s=>s.pointerId===t&&(e=s,!0))),e}_encloseToBoundary(t,e,s){const i=e.lengthSq();if(0===i)return t;const r=A.copy(e).add(t),n=this._boundary.clampPoint(r,U).sub(r),o=n.lengthSq();if(0===o)return t.add(e);if(o===i)return t;if(0===s)return t.add(e).add(n);{const i=1+s*o/e.dot(n);return t.add(A.copy(e).multiplyScalar(i)).add(n.multiplyScalar(1-s))}}_updateNearPlaneCorners(){if(r(this._camera)){const t=this._camera,e=t.near,s=t.getEffectiveFOV()*O.MathUtils.DEG2RAD,i=Math.tan(.5*s)*e,r=i*t.aspect;this._nearPlaneCorners[0].set(-r,-i,0),this._nearPlaneCorners[1].set(r,-i,0),this._nearPlaneCorners[2].set(r,i,0),this._nearPlaneCorners[3].set(-r,i,0)}else if(n(this._camera)){const t=this._camera,e=1/t.zoom,s=t.left*e,i=t.right*e,r=t.top*e,n=t.bottom*e;this._nearPlaneCorners[0].set(s,r,0),this._nearPlaneCorners[1].set(i,r,0),this._nearPlaneCorners[2].set(i,n,0),this._nearPlaneCorners[3].set(s,n,0)}}_collisionTest(){let t=1/0;if(!(this.colliderMeshes.length>=1))return t;if(u(this._camera,"_collisionTest"))return t;const e=P.setFromSpherical(this._spherical).divideScalar(this._spherical.radius);I.lookAt(T,e,this._camera.up);for(let s=0;s<4;s++){const i=A.copy(this._nearPlaneCorners[s]);i.applyMatrix4(I);const r=U.addVectors(this._target,i);B.set(r,e),B.far=this._spherical.radius+1;const n=B.intersectObjects(this.colliderMeshes);0!==n.length&&n[0].distance<t&&(t=n[0].distance)}return t}_getClientRect(t){const e=this._domElement.getBoundingClientRect();return t.x=e.left,t.y=e.top,this._viewport?(t.x+=this._viewport.x,t.y+=e.height-this._viewport.w-this._viewport.y,t.width=this._viewport.z,t.height=this._viewport.w):(t.width=e.width,t.height=e.height),t}_createOnRestPromise(t){return t?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise((t=>{const e=()=>{this.removeEventListener("rest",e),t()};this.addEventListener("rest",e)})))}_removeAllEventListeners(){}}},1289:function(t,e,s){s.d(e,{Z:function(){return h}});var i=s(655),r=s(7294),n=function(t){void 0===t&&(t={});var e=(0,r.useState)(t),s=e[0],i=e[1];return[s,(0,r.useCallback)((function(t){i((function(e){return Object.assign({},e,t instanceof Function?t(e):t)}))}),[])]};function o(t){for(var e=[],s=0;s<t.length;s++)e.push({start:t.start(s),end:t.end(s)});return e}var a,h=(a="audio",function(t){var e,s;s=r.isValidElement(t)?(e=t).props:t;var h=n({buffered:[],time:0,duration:0,paused:!0,muted:!1,volume:1,playing:!1}),c=h[0],l=h[1],d=(0,r.useRef)(null),m=function(t,e){return function(s){try{e&&e(s)}finally{t&&t(s)}}},_=function(){return l({paused:!1})},u=function(){return l({playing:!0})},p=function(){return l({playing:!1})},f=function(){return l({paused:!0,playing:!1})},y=function(){var t=d.current;t&&l({muted:t.muted,volume:t.volume})},E=function(){var t=d.current;if(t){var e=t.duration,s=t.buffered;l({duration:e,buffered:o(s)})}},g=function(){var t=d.current;t&&l({time:t.currentTime})},v=function(){var t=d.current;t&&l({buffered:o(t.buffered)})};e=e?r.cloneElement(e,(0,i.pi)((0,i.pi)({controls:!1},s),{ref:d,onPlay:m(s.onPlay,_),onPlaying:m(s.onPlaying,u),onWaiting:m(s.onWaiting,p),onPause:m(s.onPause,f),onVolumeChange:m(s.onVolumeChange,y),onDurationChange:m(s.onDurationChange,E),onTimeUpdate:m(s.onTimeUpdate,g),onProgress:m(s.onProgress,v)})):r.createElement(a,(0,i.pi)((0,i.pi)({controls:!1},s),{ref:d,onPlay:m(s.onPlay,_),onPlaying:m(s.onPlaying,u),onWaiting:m(s.onWaiting,p),onPause:m(s.onPause,f),onVolumeChange:m(s.onVolumeChange,y),onDurationChange:m(s.onDurationChange,E),onTimeUpdate:m(s.onTimeUpdate,g),onProgress:m(s.onProgress,v)}));var O=!1,T={play:function(){var t=d.current;if(t&&!O){var e=t.play();if("object"===typeof e){O=!0;var s=function(){O=!1};e.then(s,s)}return e}},pause:function(){var t=d.current;if(t&&!O)return t.pause()},seek:function(t){var e=d.current;e&&void 0!==c.duration&&(t=Math.min(c.duration,Math.max(0,t)),e.currentTime=t)},volume:function(t){var e=d.current;e&&(t=Math.min(1,Math.max(0,t)),e.volume=t,l({volume:t}))},mute:function(){var t=d.current;t&&(t.muted=!0)},unmute:function(){var t=d.current;t&&(t.muted=!1)}};return(0,r.useEffect)((function(){var t=d.current;t&&(l({volume:t.volume,muted:t.muted,paused:t.paused}),s.autoPlay&&t.paused&&T.play())}),[s.src]),[e,c,T,d]})},7462:function(t,e,s){function i(){return i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i])}return t},i.apply(this,arguments)}s.d(e,{Z:function(){return i}})}}]);